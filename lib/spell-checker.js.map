{"version":3,"sources":["../src/spell-checker.js"],"names":["CodeMirror","SpellCheckerPlugin","language","type","activate","global","inkdrop","onEditorLoad","handleEditorInit","bind","deactivate","subs","dispose","editor","getActiveEditor","codeMirror","originalMode","setOption","cm","lang","config","get","getOption","refresh","observe","logger","debug","module","exports"],"mappings":";;AAAA;;AACA;;AACA;;;;;;AAEA,wCAAaA,sBAAb;;AAEA,MAAMC,kBAAN,CAAyB;AAAA;AAAA,oCACd;AACPC,MAAAA,QAAQ,EAAE;AACRC,QAAAA,IAAI,EAAE,QADE;AAER,mBAAS,OAFD;AAGR,gBAAM,CAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,EAA4B,OAA5B,EAAqC,OAArC,EAA8C,OAA9C;AAHE;AADH,KADc;AAAA;;AASvBC,EAAAA,QAAQ,GAAG;AACTC,IAAAA,MAAM,CAACC,OAAP,CAAeC,YAAf,CAA4B,KAAKC,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAA5B;AACD;;AAEDC,EAAAA,UAAU,GAAG;AACX,QAAI,KAAKC,IAAT,EAAe,KAAKA,IAAL,CAAUC,OAAV;AACf,UAAMC,MAAM,GAAGR,MAAM,CAACC,OAAP,CAAeQ,eAAf,EAAf;;AACA,QAAID,MAAM,IAAIA,MAAM,CAACE,UAAjB,IAA+B,KAAKC,YAAxC,EAAsD;AACpDH,MAAAA,MAAM,CAACE,UAAP,CAAkBE,SAAlB,CAA4B,MAA5B,EAAoC,KAAKD,YAAzC;AACD;AACF;;AAEDR,EAAAA,gBAAgB,CAACK,MAAD,EAAS;AACvB,UAAM;AAAEK,MAAAA;AAAF,QAASL,MAAf;AACA,UAAMM,IAAI,GAAGb,OAAO,CAACc,MAAR,CAAeC,GAAf,CAAmB,wBAAnB,EAA6C,OAA7C,CAAb;AACA,SAAKL,YAAL,GAAoBE,EAAE,CAACI,SAAH,CAAa,MAAb,CAApB;AACAJ,IAAAA,EAAE,CAACD,SAAH,CAAa,gBAAb,EAA+BE,IAA/B;AACAD,IAAAA,EAAE,CAACD,SAAH,CAAa,UAAb,EAAyB,KAAKD,YAA9B;AACAE,IAAAA,EAAE,CAACD,SAAH,CAAa,MAAb,EAAqB,eAArB;AACAC,IAAAA,EAAE,CAACK,OAAH;AAEA,SAAKZ,IAAL,GAAYL,OAAO,CAACc,MAAR,CAAeI,OAAf,CAAuB,wBAAvB,EAAiDL,IAAI,IAAI;AACnEM,sBAAOC,KAAP,CAAa,gCAAb,EAA+CP,IAA/C;;AACAD,MAAAA,EAAE,CAACD,SAAH,CAAa,gBAAb,EAA+BE,IAA/B;AACD,KAHW,CAAZ;AAID;;AAlCsB;;AAqCzBQ,MAAM,CAACC,OAAP,GAAiB,IAAI3B,kBAAJ,EAAjB","sourcesContent":["import { logger } from 'inkdrop'\nimport SpellChecker from '@inkdropapp/codemirror-spell-checker'\nimport CodeMirror from 'codemirror'\n\nSpellChecker(CodeMirror)\n\nclass SpellCheckerPlugin {\n  config = {\n    language: {\n      type: 'string',\n      default: 'en_US',\n      enum: ['de_DE', 'en_AU', 'en_CA', 'en_GB', 'en_US', 'fr_FR']\n    }\n  }\n\n  activate() {\n    global.inkdrop.onEditorLoad(this.handleEditorInit.bind(this))\n  }\n\n  deactivate() {\n    if (this.subs) this.subs.dispose()\n    const editor = global.inkdrop.getActiveEditor()\n    if (editor && editor.codeMirror && this.originalMode) {\n      editor.codeMirror.setOption('mode', this.originalMode)\n    }\n  }\n\n  handleEditorInit(editor) {\n    const { cm } = editor\n    const lang = inkdrop.config.get('spell-checker.language', 'en_US')\n    this.originalMode = cm.getOption('mode')\n    cm.setOption('spellCheckLang', lang)\n    cm.setOption('backdrop', this.originalMode)\n    cm.setOption('mode', 'spell-checker')\n    cm.refresh()\n\n    this.subs = inkdrop.config.observe('spell-checker.language', lang => {\n      logger.debug('Spellchecker language changed:', lang)\n      cm.setOption('spellCheckLang', lang)\n    })\n  }\n}\n\nmodule.exports = new SpellCheckerPlugin()\n"],"file":"spell-checker.js"}